// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0

package store

import (
	"database/sql"
	"database/sql/driver"
	"encoding/json"
	"fmt"
	"time"

	"github.com/google/uuid"
	"github.com/sqlc-dev/pqtype"
)

type WatchlistItemType string

const (
	WatchlistItemTypePackage WatchlistItemType = "package"
	WatchlistItemTypeCpe     WatchlistItemType = "cpe"
)

func (e *WatchlistItemType) Scan(src interface{}) error {
	switch s := src.(type) {
	case []byte:
		*e = WatchlistItemType(s)
	case string:
		*e = WatchlistItemType(s)
	default:
		return fmt.Errorf("unsupported scan type for WatchlistItemType: %T", src)
	}
	return nil
}

type NullWatchlistItemType struct {
	WatchlistItemType WatchlistItemType
	Valid             bool // Valid is true if WatchlistItemType is not NULL
}

// Scan implements the Scanner interface.
func (ns *NullWatchlistItemType) Scan(value interface{}) error {
	if value == nil {
		ns.WatchlistItemType, ns.Valid = "", false
		return nil
	}
	ns.Valid = true
	return ns.WatchlistItemType.Scan(value)
}

// Value implements the driver Valuer interface.
func (ns NullWatchlistItemType) Value() (driver.Value, error) {
	if !ns.Valid {
		return nil, nil
	}
	return string(ns.WatchlistItemType), nil
}

type AlertEvent struct {
	ID               uuid.UUID
	RuleID           uuid.UUID
	OrgID            uuid.UUID
	CveID            string
	MaterialHash     string
	LastMatchState   bool
	SuppressDelivery bool
	FirstFiredAt     time.Time
	LastFiredAt      time.Time
	TimesFired       int32
}

type AlertRule struct {
	ID                       uuid.UUID
	OrgID                    uuid.UUID
	Name                     string
	Logic                    string
	Conditions               json.RawMessage
	WatchlistIds             []uuid.UUID
	DslVersion               int32
	HasEpssCondition         bool
	IsEpssOnly               bool
	Status                   string
	FireOnNonMaterialChanges bool
	CreatedAt                time.Time
	UpdatedAt                time.Time
	DeletedAt                sql.NullTime
}

type AlertRuleChannel struct {
	RuleID    uuid.UUID
	ChannelID uuid.UUID
	OrgID     uuid.UUID
	CreatedAt time.Time
}

type AlertRuleRun struct {
	ID                  uuid.UUID
	RuleID              uuid.UUID
	OrgID               uuid.UUID
	Path                string
	Status              string
	StartedAt           time.Time
	FinishedAt          sql.NullTime
	CandidatesEvaluated int32
	MatchesFound        int32
	ErrorMessage        sql.NullString
}

type ApiKey struct {
	ID              uuid.UUID
	OrgID           uuid.UUID
	CreatedByUserID uuid.UUID
	KeyHash         string
	Name            string
	Role            string
	ExpiresAt       sql.NullTime
	LastUsedAt      sql.NullTime
	CreatedAt       time.Time
	RevokedAt       sql.NullTime
}

type Cfe struct {
	CveID                 string
	Status                sql.NullString
	DatePublished         sql.NullTime
	DateModifiedSourceMax sql.NullTime
	DateModifiedCanonical time.Time
	DateFirstSeen         time.Time
	DescriptionPrimary    sql.NullString
	Severity              sql.NullString
	CvssV3Score           sql.NullFloat64
	CvssV3Vector          sql.NullString
	CvssV3Source          sql.NullString
	CvssV4Score           sql.NullFloat64
	CvssV4Vector          sql.NullString
	CvssV4Source          sql.NullString
	CvssScoreDiverges     bool
	CweIds                []string
	ExploitAvailable      bool
	InCisaKev             bool
	EpssScore             sql.NullFloat64
	DateEpssUpdated       sql.NullTime
	MaterialHash          sql.NullString
}

type CveAffectedCpe struct {
	ID            uuid.UUID
	CveID         string
	Cpe           string
	CpeNormalized string
}

type CveAffectedPackage struct {
	ID           uuid.UUID
	CveID        string
	Ecosystem    string
	PackageName  string
	Namespace    sql.NullString
	RangeType    sql.NullString
	Introduced   sql.NullString
	Fixed        sql.NullString
	LastAffected sql.NullString
	Events       pqtype.NullRawMessage
}

type CveRawPayload struct {
	ID         uuid.UUID
	CveID      string
	SourceName string
	IngestedAt time.Time
	Payload    json.RawMessage
}

type CveReference struct {
	ID           uuid.UUID
	CveID        string
	Url          string
	UrlCanonical string
	Tags         []string
}

type CveSearchIndex struct {
	CveID       string
	FtsDocument interface{}
}

type CveSource struct {
	CveID              string
	SourceName         string
	SourceID           sql.NullString
	NormalizedJson     json.RawMessage
	SourceDateModified sql.NullTime
	SourceUrl          sql.NullString
	IngestedAt         time.Time
}

type CweDictionary struct {
	CweID       string
	Name        string
	Description sql.NullString
}

type EpssStaging struct {
	CveID      string
	EpssScore  float64
	AsOfDate   time.Time
	IngestedAt time.Time
}

type FeedFetchLog struct {
	ID            uuid.UUID
	FeedName      string
	StartedAt     time.Time
	EndedAt       sql.NullTime
	Status        string
	ItemsFetched  int32
	ItemsUpserted int32
	CursorBefore  pqtype.NullRawMessage
	CursorAfter   pqtype.NullRawMessage
	ErrorSummary  sql.NullString
}

type FeedSyncState struct {
	FeedName            string
	CursorJson          pqtype.NullRawMessage
	LastSuccessAt       sql.NullTime
	LastAttemptAt       sql.NullTime
	ConsecutiveFailures int32
	LastError           sql.NullString
	BackoffUntil        sql.NullTime
}

type Group struct {
	ID          uuid.UUID
	OrgID       uuid.UUID
	Name        string
	Description string
	CreatedAt   time.Time
	DeletedAt   sql.NullTime
}

type GroupMember struct {
	ID        uuid.UUID
	OrgID     uuid.UUID
	GroupID   uuid.UUID
	UserID    uuid.UUID
	CreatedAt time.Time
}

type JobQueue struct {
	ID          uuid.UUID
	Queue       string
	Priority    int32
	Payload     json.RawMessage
	LockKey     sql.NullString
	Status      string
	RunAfter    time.Time
	Attempts    int32
	MaxAttempts int32
	LockedBy    sql.NullString
	LockedAt    sql.NullTime
	CreatedAt   time.Time
	FinishedAt  sql.NullTime
	LastError   sql.NullString
}

type NotificationChannel struct {
	ID                     uuid.UUID
	OrgID                  uuid.UUID
	Name                   string
	Type                   string
	Config                 json.RawMessage
	SigningSecret          string
	SigningSecretSecondary sql.NullString
	DeletedAt              sql.NullTime
	CreatedAt              time.Time
	UpdatedAt              time.Time
}

type NotificationDelivery struct {
	ID              uuid.UUID
	OrgID           uuid.UUID
	RuleID          uuid.UUID
	ChannelID       uuid.UUID
	Status          string
	AttemptCount    int32
	Payload         json.RawMessage
	SendAfter       time.Time
	LastAttemptedAt sql.NullTime
	DeliveredAt     sql.NullTime
	LastError       sql.NullString
	CreatedAt       time.Time
	UpdatedAt       time.Time
}

type OrgInvitation struct {
	ID         uuid.UUID
	OrgID      uuid.UUID
	Email      string
	Role       string
	Token      string
	CreatedBy  uuid.UUID
	ExpiresAt  time.Time
	AcceptedAt sql.NullTime
	CreatedAt  time.Time
}

type OrgMember struct {
	OrgID     uuid.UUID
	UserID    uuid.UUID
	Role      string
	CreatedAt time.Time
	UpdatedAt time.Time
}

type Organization struct {
	ID        uuid.UUID
	Name      string
	CreatedAt time.Time
	DeletedAt sql.NullTime
}

type RefreshToken struct {
	Jti           uuid.UUID
	UserID        uuid.UUID
	TokenVersion  int32
	ExpiresAt     time.Time
	UsedAt        sql.NullTime
	ReplacedByJti uuid.NullUUID
	CreatedAt     time.Time
}

type SystemJobsLog struct {
	ID           uuid.UUID
	JobType      string
	StartedAt    time.Time
	EndedAt      sql.NullTime
	Status       string
	Details      pqtype.NullRawMessage
	ErrorSummary sql.NullString
}

type User struct {
	ID                  uuid.UUID
	Email               string
	DisplayName         string
	PasswordHash        sql.NullString
	PasswordHashVersion int32
	TokenVersion        int32
	CreatedAt           time.Time
	LastLoginAt         sql.NullTime
}

type UserIdentity struct {
	ID             uuid.UUID
	UserID         uuid.UUID
	Provider       string
	ProviderUserID string
	Email          string
	CreatedAt      time.Time
}

type Watchlist struct {
	ID          uuid.UUID
	OrgID       uuid.UUID
	GroupID     uuid.NullUUID
	Name        string
	Description sql.NullString
	CreatedAt   time.Time
	UpdatedAt   time.Time
	DeletedAt   sql.NullTime
}

type WatchlistItem struct {
	ID            uuid.UUID
	WatchlistID   uuid.UUID
	OrgID         uuid.UUID
	ItemType      WatchlistItemType
	Ecosystem     sql.NullString
	PackageName   sql.NullString
	Namespace     sql.NullString
	CpeNormalized sql.NullString
	CreatedAt     time.Time
	DeletedAt     sql.NullTime
}
